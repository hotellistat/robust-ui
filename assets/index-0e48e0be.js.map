{"version":3,"file":"index-0e48e0be.js","sources":["../../src/components/Img/index.ts"],"sourcesContent":["import { defineComponent, h, onMounted, ref, toRefs, watch } from 'vue';\nimport RobustSpinner from '../Spinner/index.vue';\nimport { PhWarning } from '@phosphor-icons/vue';\nexport default defineComponent({\n  name: 'RobustImg',\n\n  props: {\n    src: {\n      type: String,\n      required: true,\n    },\n    fallbackSrc: {\n      type: String,\n      default: undefined,\n    },\n  },\n\n  emits: ['loaded', 'error'],\n\n  setup(props, { emit }) {\n    const loading = ref(true);\n    const error = ref(false);\n\n    const { src } = toRefs(props);\n\n    const image = new Image();\n\n    image.onload = () => {\n      emit('loaded', true);\n      loading.value = false;\n    };\n\n    image.onerror = (e) => {\n      emit('error', e);\n      error.value = true;\n      loading.value = false;\n    };\n\n    onMounted(() => {\n      image.src = src.value;\n    });\n\n    watch(src, () => {\n      image.src = src.value;\n    });\n\n    return {\n      error,\n      loading,\n    };\n  },\n\n  render() {\n    if (this.loading) {\n      return h(\n        'div',\n        {\n          class: 'flex items-center justify-center',\n        },\n        h(RobustSpinner, {\n          size: 24,\n          stroke: 2,\n        })\n      );\n    } else if (this.error) {\n      if (this.fallbackSrc) {\n        return h('img', {\n          src: this.fallbackSrc,\n        });\n      } else {\n        return h(PhWarning, {\n          size: 20,\n        });\n      }\n    } else {\n      return h('img', {\n        src: this.src,\n      });\n    }\n  },\n});\n"],"names":["RobustImg","defineComponent","props","emit","loading","ref","error","src","toRefs","image","e","onMounted","watch","h","RobustSpinner","PhWarning"],"mappings":"6KAGA,MAAAA,EAAeC,EAAgB,CAC7B,KAAM,YAEN,MAAO,CACL,IAAK,CACH,KAAM,OACN,SAAU,EACZ,EACA,YAAa,CACX,KAAM,OACN,QAAS,MACX,CACF,EAEA,MAAO,CAAC,SAAU,OAAO,EAEzB,MAAMC,EAAO,CAAE,KAAAC,GAAQ,CACf,MAAAC,EAAUC,EAAI,EAAI,EAClBC,EAAQD,EAAI,EAAK,EAEjB,CAAE,IAAAE,CAAA,EAAQC,EAAON,CAAK,EAEtBO,EAAQ,IAAI,MAElB,OAAAA,EAAM,OAAS,IAAM,CACnBN,EAAK,SAAU,EAAI,EACnBC,EAAQ,MAAQ,EAAA,EAGZK,EAAA,QAAWC,GAAM,CACrBP,EAAK,QAASO,CAAC,EACfJ,EAAM,MAAQ,GACdF,EAAQ,MAAQ,EAAA,EAGlBO,EAAU,IAAM,CACdF,EAAM,IAAMF,EAAI,KAAA,CACjB,EAEDK,EAAML,EAAK,IAAM,CACfE,EAAM,IAAMF,EAAI,KAAA,CACjB,EAEM,CACL,MAAAD,EACA,QAAAF,CAAA,CAEJ,EAEA,QAAS,CACP,OAAI,KAAK,QACAS,EACL,MACA,CACE,MAAO,kCACT,EACAA,EAAEC,EAAe,CACf,KAAM,GACN,OAAQ,CAAA,CACT,CAAA,EAEM,KAAK,MACV,KAAK,YACAD,EAAE,MAAO,CACd,IAAK,KAAK,WAAA,CACX,EAEMA,EAAEE,EAAW,CAClB,KAAM,EAAA,CACP,EAGIF,EAAE,MAAO,CACd,IAAK,KAAK,GAAA,CACX,CAEL,CACF,CAAC"}