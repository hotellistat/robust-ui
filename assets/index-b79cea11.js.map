{"version":3,"file":"index-b79cea11.js","sources":["../../src/components/Slider/index.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"slider\"\n    class=\"base-slider\"\n    role=\"slider\"\n    :aria-valuemax=\"moderatedMax()\"\n    :aria-valuemin=\"moderatedMin()\"\n    :aria-valuenow=\"localValue\"\n    :class=\"classes\"\n    :tabindex=\"disabled ? null : tabindex || '0'\"\n    @blur=\"onBlur\"\n    @focus=\"onFocus\"\n    @keydown.down.prevent=\"decrementValue\"\n    @keydown.left.prevent=\"decrementValue\"\n    @keydown.right.prevent=\"incrementValue\"\n    @keydown.up.prevent=\"incrementValue\"\n  >\n    <input\n      v-if=\"name\"\n      class=\"base-slider__hidden-input\"\n      type=\"hidden\"\n      :name=\"name\"\n      :value=\"modelValue\"\n    />\n\n    <div\n      ref=\"track\"\n      class=\"base-slider__track relative w-full\"\n      @mousedown=\"onDragStart\"\n      @touchstart=\"onDragStart\"\n    >\n      <div class=\"base-slider__track-background bg-gray-300 dark:bg-gray-400\">\n        <div v-if=\"snapToSteps\">\n          <span\n            v-for=\"(point, idx) in snapPoints\"\n            :key=\"idx\"\n            class=\"base-slider__snap-point\"\n            :style=\"{ left: 100 * relativeValue(point) + '%' }\"\n          ></span>\n        </div>\n      </div>\n\n      <div\n        class=\"base-slider__track-fill bg-primary-400\"\n        :style=\"fillStyle\"\n      ></div>\n\n      <div\n        ref=\"thumb\"\n        class=\"base-slider__thumb bg-primary-400\"\n        :style=\"thumbStyle\"\n      >\n        <div v-if=\"showMarker\" class=\"base-slider__marker text-xs\">\n          <span class=\"text-xs text-gray-400 dark:text-gray-500\">{{\n            markerText\n          }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, onBeforeUnmount, onMounted, ref } from 'vue';\n\nconst props = defineProps({\n  name: {\n    type: String,\n    default: undefined,\n  },\n  tabindex: {\n    type: [String, Number],\n    default: undefined,\n  },\n  modelValue: {\n    type: Number,\n    required: true,\n  },\n  min: {\n    type: Number,\n    default: 0,\n  },\n  max: {\n    type: Number,\n    default: 100,\n  },\n  step: {\n    type: Number,\n    default: 10,\n  },\n  snapToSteps: {\n    type: Boolean,\n    default: false,\n  },\n  showMarker: {\n    type: Boolean,\n    default: false,\n  },\n  markerValue: {\n    type: [String, Number],\n    default: undefined,\n  },\n  disabled: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nconst emit = defineEmits([\n  'focus',\n  'blur',\n  'update:modelValue',\n  'change',\n  'dragstart',\n  'dragend',\n]);\n\nconst initialValue = ref(props.modelValue);\nconst isActive = ref(false);\nconst isDragging = ref(false);\nconst localValue = ref(props.modelValue);\nconst slider = ref();\nconst track = ref();\nconst thumb = ref();\n\nconst classes = computed(() => {\n  return [\n    { 'is-dragging': isDragging.value },\n    { 'is-disabled': props.disabled },\n    { 'is-active': isActive.value },\n    { 'has-marker': props.showMarker },\n  ];\n});\n\nconst fillStyle = computed(() => {\n  return { transform: 'scaleX(' + relativeValue(localValue.value) + ')' };\n});\n\nconst thumbStyle = computed(() => {\n  return {\n    left: relativeValue(localValue.value) * 100 + '%',\n  };\n});\n\nconst markerText = computed(() => {\n  return props.markerValue === undefined ? props.modelValue : props.markerValue;\n});\n\nconst snapPoints = computed(() => {\n  const points = [];\n  let point = props.step * Math.ceil(moderatedMin() / props.step);\n\n  while (point <= moderatedMax()) {\n    points.push(point);\n    point += props.step;\n  }\n\n  return points;\n});\n\nconst moderatedMin = () => {\n  return props.max > props.min ? props.min : 0;\n};\n\nconst moderatedMax = () => {\n  return props.max > props.min ? props.max : 100;\n};\n\nconst focus = () => {\n  slider.value.focus();\n};\n\nconst reset = () => {\n  setValue(initialValue);\n};\n\nconst onFocus = () => {\n  isActive.value = true;\n  emit('focus');\n};\n\nconst onBlur = () => {\n  isActive.value = false;\n  emit('blur');\n};\n\nconst onExternalClick = (e) => {\n  if (!slider.value.contains(e.target)) {\n    onBlur();\n  }\n};\n\nconst setValueWithSnap = (value) => {\n  value = moderateValue(value);\n\n  if (props.snapToSteps) {\n    value = getNearestSnapPoint(value);\n  }\n\n  setValue(value);\n};\n\nconst setValue = (value) => {\n  value = moderateValue(value);\n\n  if (value === localValue.value) {\n    return;\n  }\n\n  localValue.value = value;\n  emit('update:modelValue', value);\n  emit('change', value);\n};\n\nconst incrementValue = () => {\n  setValueWithSnap(localValue.value + props.step);\n};\n\nconst decrementValue = () => {\n  setValueWithSnap(localValue.value - props.step);\n};\n\nconst getPointStyle = (point) => {\n  return {\n    left: point + '%',\n  };\n};\n\nconst initializeSlider = () => {\n  document.addEventListener('touchend', onDragStop);\n  document.addEventListener('mouseup', onDragStop);\n  document.addEventListener('click', onExternalClick);\n  document.addEventListener('touchstart', onExternalClick);\n  initializeDrag();\n};\n\nconst teardownSlider = () => {\n  document.removeEventListener('touchend', onDragStop);\n  document.removeEventListener('mouseup', onDragStop);\n  document.removeEventListener('click', onExternalClick);\n};\n\nconst initializeDrag = () => {\n  const value = moderateValue(localValue.value ? localValue.value : 0);\n  setValue(value);\n};\n\nconst onDragStart = (e) => {\n  if (props.disabled) {\n    return;\n  }\n\n  if (!isActive.value) {\n    onFocus();\n  }\n\n  isDragging.value = true;\n  dragUpdate(e);\n\n  document.addEventListener('touchmove', onDragMove);\n  document.addEventListener('mousemove', onDragMove);\n\n  emit('dragstart', localValue.value, e);\n};\n\nconst onDragMove = (e) => {\n  dragUpdate(e);\n};\n\nconst dragUpdate = (e) => {\n  const sliderOffsetLeft = track.value!.getBoundingClientRect().left;\n  const position = e.touches ? e.touches[0].pageX : e.pageX;\n  const trackLength = track.value.offsetWidth;\n  const relativeValue = (position - sliderOffsetLeft) / trackLength;\n\n  const value = moderateValue(\n    moderatedMin() + relativeValue * (moderatedMax() - moderatedMin())\n  );\n\n  if (isDragging.value) {\n    setValue(Math.round(value));\n  }\n};\n\nconst onDragStop = (e) => {\n  if (isDragging.value) {\n    isDragging.value = false;\n\n    if (props.snapToSteps && props.modelValue % props.step !== 0) {\n      setValueWithSnap(props.modelValue);\n    }\n\n    document.removeEventListener('touchmove', onDragMove);\n    document.removeEventListener('mousemove', onDragMove);\n\n    emit('dragend', localValue.value, e);\n  }\n};\n\nconst getNearestSnapPoint = (value) => {\n  const previousSnapPoint = Math.floor(value / props.step) * props.step;\n  const nextSnapPoint = previousSnapPoint + props.step;\n  const midpoint = (previousSnapPoint + nextSnapPoint) / 2;\n\n  if (previousSnapPoint < moderatedMin()) {\n    if (nextSnapPoint > moderatedMax()) {\n      return value;\n    }\n    return nextSnapPoint;\n  }\n  if (value >= midpoint && nextSnapPoint <= moderatedMax()) {\n    return nextSnapPoint;\n  }\n  return previousSnapPoint;\n};\n\nconst relativeValue = (value) => {\n  return (value - moderatedMin()) / (moderatedMax() - moderatedMin());\n};\n\nconst moderateValue = (value) => {\n  if (value < moderatedMin()) {\n    return moderatedMin();\n  }\n\n  if (value > moderatedMax()) {\n    return moderatedMax();\n  }\n\n  return value;\n};\n\n// debugging needs to be done\n/*watch(props.value, () => {\n      setValue(props.modelValue);\n    });*/\n\nonMounted(() => {\n  initializeSlider();\n});\n\nonBeforeUnmount(() => {\n  teardownSlider();\n});\n\ndefineExpose({\n  getPointStyle,\n  focus,\n  reset,\n});\n</script>\n\n<style>\n.base-slider {\n  align-items: center;\n  display: flex;\n  outline: none;\n}\n\n.base-slider:not(.is-disabled).is-active .base-slider__marker,\n.base-slider:not(.is-disabled).is-dragging .base-slider__marker {\n  opacity: 1;\n  transform: scale(1) translateY(-26px);\n}\n\n.base-slider:not(.is-disabled).is-active .base-slider__marker-text,\n.base-slider:not(.is-disabled).is-dragging .base-slider__marker-text {\n  color: white;\n}\n\n.base-slider:not(.is-disabled).is-active .base-slider__snap-point,\n.base-slider:not(.is-disabled).is-dragging .base-slider__snap-point {\n  opacity: 1;\n}\n\n.base-slider.is-disabled .base-slider__track {\n  cursor: default;\n}\n\n.base-slider.is-disabled .base-slider__track-fill {\n  background-color: transparent;\n}\n\n.base-slider.is-disabled .base-slider__thumb {\n  background-color: #ddd;\n  border: 2px solid white;\n}\n\n.base-slider__track {\n  align-items: center;\n  cursor: default;\n  display: flex;\n  height: 18px;\n  margin: 0 auto;\n  position: relative;\n  width: 100%;\n}\n\n.base-slider__track-background,\n.base-slider__track-fill {\n  content: '';\n  display: block;\n  height: 3px;\n  left: 0;\n  position: absolute;\n  top: 7px;\n}\n\n.base-slider__track-background {\n  width: 100%;\n}\n\n.base-slider__snap-point {\n  background-color: rgba(0, 0, 0, 0.75);\n  height: 3px;\n  opacity: 0;\n  position: absolute;\n  transition: opacity 0.2s ease;\n  width: 2px;\n  z-index: 1;\n}\n\n.base-slider__track-fill {\n  transform-origin: left;\n  width: 100%;\n}\n\n.base-slider__thumb {\n  border-radius: 50%;\n  cursor: inherit;\n  display: block;\n  height: 14px;\n  left: 0;\n  position: absolute;\n  width: 14px;\n  z-index: 1;\n  margin-left: -7px;\n}\n\n.base-slider__thumb::before {\n  background-color: #93c5fd;\n  opacity: 0.3;\n  border-radius: 50%;\n  content: '';\n  display: block;\n  height: 36px;\n  margin-left: -12px;\n  margin-top: -12px;\n  position: absolute;\n  transform-origin: center;\n  transform: scale(0);\n  transition: transform 0.2s ease;\n  width: 36px;\n}\n\n.base-slider__marker {\n  height: 24px;\n  opacity: 0;\n  position: absolute;\n  transform: scale(0) translateY(0);\n  transition: all 0.2s ease;\n  margin-left: -5px;\n  width: 24px;\n  user-select: none;\n}\n\n.base-slider__marker svg {\n  fill: #7f97ee;\n  height: 24px;\n  width: 24px;\n}\n\n.base-slider__marker-text {\n  color: white;\n  font-size: 13px;\n  font-weight: 600;\n  left: 4.5px;\n  position: absolute;\n  text-align: center;\n  top: 1px;\n  transition: color 0.2s ease;\n  width: 14px;\n}\n\n.base-slider--is-dragging {\n  user-select: none;\n}\n</style>\n"],"names":["initialValue","ref","props","isActive","isDragging","localValue","slider","track","thumb","classes","computed","fillStyle","relativeValue","thumbStyle","markerText","snapPoints","points","point","moderatedMin","moderatedMax","focus","reset","setValue","onFocus","emit","onBlur","onExternalClick","setValueWithSnap","value","moderateValue","getNearestSnapPoint","incrementValue","decrementValue","getPointStyle","initializeSlider","onDragStop","initializeDrag","teardownSlider","onDragStart","dragUpdate","onDragMove","sliderOffsetLeft","position","trackLength","previousSnapPoint","nextSnapPoint","midpoint","onMounted","onBeforeUnmount","expose"],"mappings":"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"}